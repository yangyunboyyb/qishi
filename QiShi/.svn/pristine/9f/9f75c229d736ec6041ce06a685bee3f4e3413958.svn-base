window.__require=function e(t,a,i){function r(s,c){if(!a[s]){if(!t[s]){var o=s.split("/");if(o=o[o.length-1],!t[o]){var l="function"==typeof __require&&__require;if(!c&&l)return l(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+s+"'")}}var g=a[s]={exports:{}};t[s][0].call(g.exports,function(e){return r(t[s][1][e]||e)},g,g.exports,e,t,a,i)}return a[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<i.length;s++)r(i[s]);return r}({RankItem:[function(e,t,a){"use strict";cc._RF.push(t,"3a420G4jJVH7YWM8cGo4u5V","RankItem");var i=e("Utils");cc.Class({extends:cc.Component,properties:{userHead:cc.Sprite,userName:cc.Label,rankLabel:cc.Label,rankimg:cc.Sprite,userScore:cc.Label},init:function(e,t,a){this.userName.string=t.nickname;var r=t.avatarUrl;i.createImage(r,this.userHead);var n="0";t.KVDataList&&"{}"!=JSON.stringify(t.KVDataList)&&(n=t.KVDataList[0].value),this.userScore.string="\u7b2c"+n+"\u5173",e<3?(this.rankLabel.node.active=!1,this.rankimg.node.active=!0,this.rankimg.spriteFrame=a[e]):(this.rankimg.node.active=!1,this.rankLabel.node.active=!0,this.rankLabel.string=e+1+"")}}),cc._RF.pop()},{Utils:"Utils"}],RankList:[function(e,t,a){"use strict";cc._RF.push(t,"10903vGc+RFi5BMgHjBCdJG","RankList");var i=e("Utils");cc.Class({extends:cc.Component,properties:{rankItemNode:cc.Node,scrollView:cc.ScrollView,labelLoading:cc.Label,rankItemPre:cc.Prefab,indexImg:[cc.SpriteFrame],gameOver:cc.Node,friendNode:cc.Node},start:function(){var e=this;wx.onMessage(function(t){2==t.messageType?(e.gameOver.active=!1,e.friendNode.active=!0,e.fetchFriendData(t.MAIN_MENU_NUM)):1==t.messageType&&(e.gameOver.active=!0,e.friendNode.active=!1,e.gameOverData(t))})},removeChild:function(){this.scrollView.content.removeAllChildren(),this.rankItemNode.active=!1,this.labelLoading.node.active=!0,this.labelLoading.string="\u52a0\u8f7d\u4e2d..."},fetchFriendData:function(e){var t=this;this.removeChild(),wx.getUserInfo({openIdList:["selfOpenId"],lang:"zh_CN",success:function(a){t.labelLoading.node.active=!1;var i=a.data[0];wx.getFriendCloudStorage({keyList:[e],success:function(e){t.labelLoading.node.active=!1,console.log("-------success getFriendCloudStorage-----\x3e",e);var a=e.data;a.sort(function(e,t){return e?t?e.KVDataList?t.KVDataList?0==e.KVDataList.length?1:0==t.KVDataList.length?-1:0==e.KVDataList.length||0==t.KVDataList.length?0:t.KVDataList[0].value-e.KVDataList[0].value:-1:1:-1:1});var r=0;for(var n in a){var s=a[n];if(s&&0!=s.KVDataList.length){i.avatarUrl==s.avatarUrl&&t.showMeRank(s,r);var c=cc.instantiate(t.rankItemPre);c.getComponent("RankItem").init(r,s,t.indexImg),t.scrollView.content.addChild(c),r++}}},fail:function(e){t.labelLoading.active=!0,t.labelLoading.string="\u52a0\u8f7d\u5931\u8d25..."}})},fail:function(e){t.labelLoading.active=!0,t.labelLoading.string="\u52a0\u8f7d\u5931\u8d25..."}})},showMeRank:function(e,t){this.rankItemNode.active=!0;var a=this.rankItemNode.getChildByName("nickname").getComponent(cc.Label),r=this.rankItemNode.getChildByName("ranklabel").getComponent(cc.Label),n=this.rankItemNode.getChildByName("imgrank").getComponent(cc.Sprite),s=this.rankItemNode.getChildByName("labelscore").getComponent(cc.Label);a.string=e.nickname;var c=e.avatarUrl;i.createImage(c,this.rankItemNode.getChildByName("headspr").getComponent(cc.Sprite));var o="0";e.KVDataList&&"{}"!=JSON.stringify(e.KVDataList)&&(o=e.KVDataList[0].value),s.string=o+"\u5206",t<3?(r.node.active=!1,n.node.active=!0,n.spriteFrame=this.indexImg[t]):(n.node.active=!1,r.node.active=!0,r.string=t+1)},gameOverData:function(e){var t=this;wx.getUserInfo({openIdList:["selfOpenId"],lang:"zh_CN",success:function(a){t.gameOver.active=!0;var i=a.data[0];wx.getFriendCloudStorage({keyList:[e.MAIN_MENU_NUM],success:function(a){t.gameOver.active=!0,console.log("-------success getFriendCloudStorage-----\x3e",a);var r=a.data;for(var n in r)i.avatarUrl==r[n].avatarUrl&&(r[n].KVDataList[0].value=e.curScore);r.sort(function(e,t){return e?t?e.KVDataList?t.KVDataList?0==e.KVDataList.length?1:0==t.KVDataList.length?-1:0==e.KVDataList.length||0==t.KVDataList.length?0:t.KVDataList[0].value-e.KVDataList[0].value:-1:1:-1:1});var s=0;for(var c in r){if(i.avatarUrl==r[c].avatarUrl)break;s++}t.showOtherScore(t.gameOver.getChildByName("smallnode"),r[s+1]),t.showOtherScore(t.gameOver.getChildByName("bignode"),r[s-1])},fail:function(e){t.gameOver.active=!1}})},fail:function(e){t.gameOver.active=!1}})},showOtherScore:function(e,t){if(t){var a=t.avatarUrl,r=e.getChildByName("userhead").getChildByName("mask").getChildByName("headspr").getComponent(cc.Sprite);i.createImage(a,r);var n=e.getChildByName("labelscore").getComponent(cc.Label),s="0";t.KVDataList&&"{}"!=JSON.stringify(t.KVDataList)&&(s=t.KVDataList[0].value),n.string=s}else e.active=!1}}),cc._RF.pop()},{Utils:"Utils"}],Utils:[function(e,t,a){"use strict";cc._RF.push(t,"17600xKjapCpL/l4sTJ2uwM","Utils"),t.exports={createImage:function(e,t){var a=this;e&&cc.loader.load({url:e,type:"png"},function(e,i){if(!e&&a){var r=t;r.spriteFrame=new cc.SpriteFrame(i),r.type=cc.Sprite.Type.SIMPLE,r.sizeMode=cc.Sprite.SizeMode.CUSTOM}})}},cc._RF.pop()},{}]},{},["RankItem","RankList","Utils"]);